"use strict";const dataResults=document.querySelector(".js-container"),userSearch=document.querySelector(".js-input"),btn=document.querySelector(".js-btn");let films=[],favoriteFilms=[];function setLocalStorage(){localStorage.setItem("favorite",JSON.stringify(favoriteFilms))}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("favorite"));null!==e?(favoriteFilms=e,paintFavorites()):getServerData()}function getServerData(){fetch(`http://api.tvmaze.com/search/shows?q=${userSearchnp.value}`).then(e=>e.json()).then(function(e){films=e,getLocalStorage(),paintFilms(),listenFilms()}).catch(function(e){console.log("Error al traer los datos del servidor",e)})}function paintFilms(){let e="";for(let t=0;t<films.length;t++){const i="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";if(e+=-1!==favoriteFilms.findIndex(function(e,i){return e.id===films[t].show.id})?`<li class="js-films js-film-item favorite-film" id=${films[t].show.id} >`:`<li class="js-films js-film-item" id=${films[t].show.id} >`,e+=`<h3 class="js-films-name">${films[t].show.name}</h3>`,null!==films[t].show.image){e+=`<img src="${films[t].show.image.medium}">`}else e+=`<img src="${i}"`;e+="</li>"}dataResults.innerHTML=e}function toogleFavorites(e){const t=parseInt(e.currentTarget.id),i=favoriteFilms.findIndex(function(e,i){return e.id===t});if(!0===(-1!==i))favoriteFilms.splice(i,1);else for(let e=0;e<films.length;e++)t===films[e].show.id&&favoriteFilms.push(films[e].show);paintFilms(),listenFilms(),paintFavorites(),setLocalStorage()}function paintFavorites(){const e=document.querySelector(".js-paint-favorites");let t="";for(let e=0;e<favoriteFilms.length;e++)t+=`<li class=js-favorites id='${favoriteFilms[e].id}'>`,t+=`<h3 class="favTitle">${favoriteFilms[e].name}</h3>`,null===favoriteFilms[e].image?t+='<img class="item__img"src="./assets/images/tvPlaceholder.png"/>':t+=`<img class='item__img'src='${favoriteFilms[e].image.medium}'/>`,t+="</li>";e.innerHTML=t}function handler(e){e.preventDefault(),getServerData()}function listenFilms(){const e=document.querySelectorAll(".js-film-item");for(const t of e)t.addEventListener("click",toogleFavorites)}btn.addEventListener("click",handler),getLocalStorage();